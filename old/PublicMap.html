<link href="https://fonts.googleapis.com/css?family=Lobster" rel="stylesheet" type="text/css">

<html>

<style>
body{
  background-color: gray;
}
h2{
  text-align: center;
  font-size: 22px;
  font-style: oblique;
  color: white;
}
.container{
    position: absolute;
    width: 70%;
    height: 80%;
    background-color: rgb(140,160,200);
    left: 15%;
    top: 10%;
    border-radius: 3%;
    border: 3px solid white;
}
#map{
  height: 425px;
  width: 550px;
  background-color: white;
  position: absolute;
  left: 20%;
  top: 10%;
  border-radius: 5%;
  border: 3px solid gray;
}
#home{
  position: absolute;
  margin-left: 5%;
  margin-top: 15%;
  width: 10%;
  height: 10%;
  border-radius: 5%;
  background-color: rgb(120,160,200);
  border-radius: 5%;
  border: 2px solid white;
  color: white;
}
#about{
  position: absolute;
  margin-left: 83%;
  margin-top: 15%;
  width: 10%;
  height: 10%;
  background-color: rgb(120,160,200);
  border-radius: 5%;
  border: 2px solid white;
  color: white;
}
</style>

<title> Public Map</title>

<body>
<div class="container">
  <h2>This map contains all the current reports</h2>
    <div id="map"></div>
    <a href="StartupScreen.html"><button id="home">Home</button></a>
    <a href="AboutPage.html"><button id="about">About</button></a>
</div>

<script src="https://www.gstatic.com/firebasejs/3.7.5/firebase.js"></script>
<script>
  // Initialize Firebase
  var config = {
    apiKey: "AIzaSyBHwu9L4hXrosQu67TcHLkv5y6rTegswsQ",
    authDomain: "cps406-d0ee6.firebaseapp.com",
    databaseURL: "https://cps406-d0ee6.firebaseio.com",
    projectId: "cps406-d0ee6",
    storageBucket: "cps406-d0ee6.appspot.com",
    messagingSenderId: "463280130148"
  };
  firebase.initializeApp(config);
</script>

<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBqsm8APsfhgAZ3q9BE5Q1jQtGGyTTU5CM&callback=myMap"></script>
<script>
var unverifiedMark = {
  path: 'M 2,2 2,2 2,2 2,2 2,2 z',
  fillColor: 'green',
  fillOpacity: 0.8,
  scale: 1.5,
  strokeColor: 'green',
  strokeWeight: 14,
};
var verifiedMark = {
  path: 'M 2,2 2,2 2,2 2,2 2,2 z',
  fillColor: 'red',
  fillOpacity: 0.8,
  scale: 1.5,
  strokeColor: 'red',
  strokeWeight: 14,
};
var falseMark = {
  path: 'M 2,2 2,2 2,2 2,2 2,2 z',
  fillColor: 'gray',
  fillOpacity: 0.8,
  scale: 1.5,
  strokeColor: 'gray',
  strokeWeight: 14,
};
var dispatchedMark = {
  path: 'M 2,2 2,2 2,2 2,2 2,2 z',
  fillColor: 'blue',
  fillOpacity: 0.8,
  scale: 1.5,
  strokeColor: 'blue',
  strokeWeight: 14,
};
var markerRef = firebase.database().ref('Markers');
var markerLat;//Marker Latitude
var markerLng;//Marker Longitude
var markerLoc;//Marker location
var markerDes;//Marker description
var markerStat;//Marker color
var markerCol;//Marker color
var markerType;//Marker type

function check(){
markerRef.on('value', function(snapshot){
  snapshot.forEach(function(childSnapshot){
    var childData = childSnapshot.val();
    markerLat = childData.Latitude;
    markerLng = childData.Longitude;
    markerDes = childData.Description;
    markerAdd = childData.Address;
    markerStat = "In progress";
    markerCol = childData.Color;
    markerType = childData.Type;
    markerTme = childData.TimeRecorded;
    markerLoc = (markerLat, markerLng);
    console.log(markerLat);
    console.log(markerLng);
    console.log(markerDes);
    console.log(markerAdd);
    console.log(markerStat);
    console.log(markerLoc);
  })
})
}

     /*
     Initializes the map
     */
     function initialize() {
       var toronto = { lat: 43.653908, lng: -79.384293 };
       var map = new google.maps.Map(document.getElementById('map'), {
         zoom: 12,
         center: toronto
       });
       // This event listener calls addMarker() when the map is clicked.
    /*   google.maps.event.addListener(map, 'click', function(event) {
         addMarker(location, map);
       });*/
       check();
       addMarker((markerLat, markerLng), map);
     }

   /*
   Adds the marker to the map
   (needs work such as taking all the stored points in the database and placing them on the map)
   */
     function addMarker(location, map) {
       var marker = new google.maps.Marker({
         position: location,
         map: map,
         draggable: true,
         icon: unverifiedMark,
       });

      marker.addListener('click', function(){
      alert("ProblemType: " + markerType + "\n" + "Description: " + markerDes + "\n" + "Time Reported: " + markerTme
        + "Address: " + markerAdd);
      })
     }

     google.maps.event.addDomListener(window, 'load', initialize);
</script>


</body>

</html>
